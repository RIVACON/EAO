

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EAO - easy and straight forward optimization of energy setups &mdash; EAO  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=d2ebc91c" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Einfaches Beispiel “Strom und Wärme”" href="../power_and_heat/power_and_heat_sample.html" />
    <link rel="prev" title="Samples" href="../../samples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/EAO_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../samples.html">Samples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../samples.html#simple-start-optimizing-power-consumption-with-battery-pv">Simple start: Optimizing power consumption with battery &amp; PV</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">EAO - easy and straight forward optimization of energy setups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Import-required-packages">Import required packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Load-data-&amp;-make-assumptions">Load data &amp; make assumptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Optimization">Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Interpretation-of-the-results">Interpretation of the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Another-benchmark:-Own-PV">Another benchmark: Own PV</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Putting-everything-together">Putting everything together</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#illustration-small-power-and-heat-network-in-german">Illustration: Small power and heat network (in German)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#handling-large-problems">Handling large problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#green-ppa-and-structured-downstream-contract">Green PPA and structured downstream contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#marginal-costs-in-portfolio-optimization">Marginal costs in portfolio optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#multi-commodity-optimization">Multi commodity optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#split-optimization-to-speed-up-large-problems">Split optimization (to speed up large problems)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#mixing-long-term-e-g-seasonal-and-short-term-storages-e-g-battery">Mixing long-term (e.g. seasonal) and short-term storages (e.g. battery)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#combined-heat-and-power">Combined Heat and Power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#battery-optimization-against-an-order-book">Battery optimization against an order book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#stochastic-linear-programs">Stochastic Linear Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#robust-optimization">Robust optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../samples.html#parameter-handling">Parameter handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../eao.html">EAO package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EAO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../samples.html">Samples</a></li>
      <li class="breadcrumb-item active">EAO - easy and straight forward optimization of energy setups</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/samples/grid and battery/battery_own_consumption.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="EAO---easy-and-straight-forward-optimization-of-energy-setups">
<h1>EAO - easy and straight forward optimization of energy setups<a class="headerlink" href="#EAO---easy-and-straight-forward-optimization-of-energy-setups" title="Link to this heading"></a></h1>
<section id="Import-required-packages">
<h2>Import required packages<a class="headerlink" href="#Import-required-packages" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">eaopack</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">eao</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</section>
<section id="Load-data-&amp;-make-assumptions">
<h2>Load data &amp; make assumptions<a class="headerlink" href="#Load-data-&-make-assumptions" title="Link to this heading"></a></h2>
<p>In this case we load a year of hourly power market data for Germany. Downloaded from smard.de (Bundesnetzagentur | SMARD.de); 01/11/2023 - 01/11/2024. We will use day ahead prices as well as PV production profiles. In addition we will use a standard load profile of German commercial consumers.</p>
<p>We make some basic assumptions on grid fees for commercial consumers (actual example for 2025 in the medium voltage grid) and define the characteristics on site: yearly consumption, own PV and battery.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;DE_dataset.xlsx&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">### at &gt; 2500 FLH</span>
<span class="n">grid_fees</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">grid_fees</span><span class="p">[</span><span class="s1">&#39;fix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">166000</span> <span class="c1"># €/MW</span>
<span class="n">grid_fees</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mi">13</span> <span class="c1"># €/MWh</span>

<span class="c1">######################### settings</span>
<span class="n">cons</span>    <span class="o">=</span> <span class="mi">500</span> <span class="c1"># MWh # total consumption per year (scaling the profile)</span>
<span class="n">cap_pv</span>  <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># MW (1000 flh) capacity of the on-site PV</span>
<span class="n">battery_data</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># capacity, size and efficiency of an on-site battery</span>
<span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;cap&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">.25</span> <span class="c1"># 250 kW</span>
<span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;cap&#39;</span><span class="p">]</span> <span class="c1"># 2 hours</span>
<span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;eff&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">0.9</span> <span class="c1"># 90% cycle efficiency</span>
</pre></div>
</div>
</div>
<p>For the actual optimization we need to do some settings: Defining the time grid for optimization and defining which data to use in our assets.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## prepare everything</span>
<span class="c1">## basics</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">timegrid</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">Timegrid</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span> <span class="c1"># hourly</span>

<span class="c1">## settings</span>
<span class="n">input_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">input_ts</span><span class="p">[</span><span class="s1">&#39;cons&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SLP gewerbe&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">cons</span>
<span class="n">input_ts</span><span class="p">[</span><span class="s1">&#39;pv&#39;</span><span class="p">]</span>    <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pv profile&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">cap_pv</span>
<span class="n">input_ts</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;price dah&#39;</span><span class="p">]</span>

<span class="c1"># cast to timegrid</span>
<span class="n">input_ts</span> <span class="o">=</span> <span class="n">timegrid</span><span class="o">.</span><span class="n">prices_to_grid</span><span class="p">(</span><span class="n">input_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we define the structure of our optimization problem – our portfolio. The assets may be physical assets such as the battery or contracts such as supply via the grid.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Structural setup, distinguishing own assets and supply from the grid</span>
<span class="n">behind_meter</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s1">&#39;behind meter&#39;</span><span class="p">)</span>
<span class="n">front_of_meter</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s1">&#39;front of meter&#39;</span><span class="p">)</span>

<span class="c1">### Here: No flexibility in our consumption. Easily changed by adjusting min_cap/max_cap</span>
<span class="n">consumption</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">SimpleContract</span><span class="p">(</span><span class="n">name</span>       <span class="o">=</span> <span class="s1">&#39;consumption&#39;</span><span class="p">,</span>
                                        <span class="n">nodes</span>      <span class="o">=</span> <span class="n">behind_meter</span><span class="p">,</span>
                                        <span class="n">min_cap</span>    <span class="o">=</span> <span class="s1">&#39;cons&#39;</span><span class="p">,</span>
                                        <span class="n">max_cap</span>    <span class="o">=</span> <span class="s1">&#39;cons&#39;</span><span class="p">)</span>
<span class="c1">### Our own PV module. Also here without flexibility -- easily changed</span>
<span class="n">pv</span>          <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">SimpleContract</span><span class="p">(</span><span class="n">name</span>       <span class="o">=</span> <span class="s1">&#39;pv&#39;</span><span class="p">,</span>
                                        <span class="n">nodes</span>      <span class="o">=</span> <span class="n">behind_meter</span><span class="p">,</span>
                                        <span class="n">min_cap</span>    <span class="o">=</span> <span class="s1">&#39;pv&#39;</span><span class="p">,</span>
                                        <span class="n">max_cap</span>    <span class="o">=</span> <span class="s1">&#39;pv&#39;</span><span class="p">)</span>
<span class="c1">### An on-site battery constituting out flexibility</span>
<span class="n">battery</span>     <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span>       <span class="n">name</span>       <span class="o">=</span> <span class="s1">&#39;battery&#39;</span><span class="p">,</span>
                                        <span class="n">nodes</span>      <span class="o">=</span> <span class="n">behind_meter</span><span class="p">,</span>
                                        <span class="n">cap_in</span>     <span class="o">=</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;cap&#39;</span><span class="p">],</span>
                                        <span class="n">cap_out</span>    <span class="o">=</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;cap&#39;</span><span class="p">],</span>
                                        <span class="n">eff_in</span>     <span class="o">=</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;eff&#39;</span><span class="p">],</span>
                                        <span class="n">size</span>       <span class="o">=</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">],</span>
                                        <span class="n">start_level</span><span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">],</span>
                                        <span class="n">end_level</span>  <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">battery_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">],</span>
                                        <span class="n">block_size</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>   <span class="c1"># daily optimization of battery (leaving it 1/2 full every day)</span>
                                        <span class="n">no_simult_in_out</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># Important: The battery may now charge and discharge at the same time and</span>
                                                                  <span class="c1"># &quot;burn&quot; power due to efficiency &lt; 100%. This makes computation much faster (no MIP)</span>

<span class="c1">### Supply via the grid. Note that we enabling scaling the grid connection -- since grid fees</span>
<span class="c1">#   apply on a yearly basis for the maximum load (which we will minimize utilizing our battery)</span>
<span class="n">supply</span>  <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">SimpleContract</span><span class="p">(</span>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;supply&#39;</span><span class="p">,</span>
                                        <span class="n">nodes</span>       <span class="o">=</span> <span class="n">front_of_meter</span><span class="p">,</span>
                                        <span class="n">price</span>       <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span>
                                        <span class="n">extra_costs</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span>  <span class="c1"># fee from supplier</span>
                                        <span class="n">min_cap</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="n">max_cap</span>     <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">grid_feedin</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">Transport</span><span class="p">(</span>     <span class="n">name</span>   <span class="o">=</span> <span class="s1">&#39;grid_out&#39;</span><span class="p">,</span>  <span class="c1"># unlimited feed in capacity</span>
                                        <span class="n">nodes</span>  <span class="o">=</span> <span class="p">[</span><span class="n">behind_meter</span><span class="p">,</span> <span class="n">front_of_meter</span><span class="p">],</span>
                                        <span class="n">min_cap</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="n">max_cap</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">grid_consumption_normed</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">Transport</span><span class="p">(</span><span class="n">name</span>   <span class="o">=</span> <span class="s1">&#39;grid_in_normed&#39;</span><span class="p">,</span>
                                               <span class="n">nodes</span>  <span class="o">=</span> <span class="p">[</span><span class="n">front_of_meter</span><span class="p">,</span> <span class="n">behind_meter</span><span class="p">],</span>
                                               <span class="n">costs_const</span> <span class="o">=</span> <span class="n">grid_fees</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">],</span> <span class="c1"># variable grid fees</span>
                                               <span class="n">min_cap</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                               <span class="n">max_cap</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># normed capacity (to 1 MW)</span>
<span class="n">grid_consumption</span>      <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">ScaledAsset</span><span class="p">(</span><span class="n">name</span>       <span class="o">=</span> <span class="s1">&#39;grid_in&#39;</span><span class="p">,</span>
                                               <span class="n">base_asset</span> <span class="o">=</span> <span class="n">grid_consumption_normed</span><span class="p">,</span>
                                               <span class="n">max_scale</span>  <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                                               <span class="n">fix_costs</span>  <span class="o">=</span> <span class="n">grid_fees</span><span class="p">[</span><span class="s1">&#39;fix&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">8760</span><span class="p">)</span> <span class="c1"># yearly fix capacity costs (here scaled to hourly as main time unit)</span>
<span class="c1">### We can feed in our PV own production - here at day ahead prices. If there are feed-in tariffs, price can easily be changed</span>
<span class="n">feedin</span>     <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">SimpleContract</span><span class="p">(</span><span class="n">name</span>        <span class="o">=</span> <span class="s1">&#39;feedin&#39;</span><span class="p">,</span>
                                       <span class="n">nodes</span>       <span class="o">=</span> <span class="n">front_of_meter</span><span class="p">,</span>
                                       <span class="n">price</span>       <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="c1"># assuming no feed in tariff</span>
                                       <span class="n">min_cap</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span>
                                       <span class="n">max_cap</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">portf</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">Portfolio</span><span class="p">([</span><span class="n">supply</span><span class="p">,</span> <span class="n">consumption</span><span class="p">,</span> <span class="n">grid_feedin</span><span class="p">,</span> <span class="n">grid_consumption</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="n">feedin</span><span class="p">,</span> <span class="n">battery</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>This is how the portfolio looks like. See below. We could set it up in a simpler way (without distinction into in-front-of-the-meter and behind-the-meter). However, this way everything becomes very explicit in formulation as well as later analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eao</span><span class="o">.</span><span class="n">network_graphs</span><span class="o">.</span><span class="n">create_graph</span><span class="p">(</span><span class="n">portf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/samples_grid_and_battery_battery_own_consumption_10_0.png" src="../../_images/samples_grid_and_battery_battery_own_consumption_10_0.png" />
</div>
</div>
</section>
<section id="Optimization">
<h2>Optimization<a class="headerlink" href="#Optimization" title="Link to this heading"></a></h2>
<p>The actual optimization is very simple. We collect all assets in the portfolio object and go. “extract_output” will generate straight-forward tables that can also be exported to Excel. Note that we are optimizing a full year on an hourly basis including a battery. This takes ~1 min.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">portf</span><span class="o">=</span><span class="n">portf</span><span class="p">,</span> <span class="n">timegrid</span><span class="o">=</span><span class="n">timegrid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">input_ts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">])</span>
<span class="n">eao</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">output_to_file</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span> <span class="c1">### All details. Have look into the file</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Values
Parameter
status       successful
value     -29974.687926
</pre></div></div>
</div>
<p>Defining the benchmark to calculate the value of the battery: The same portfolio without the battery</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">portf_benchmark</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">portfolio</span><span class="o">.</span><span class="n">Portfolio</span><span class="p">([</span><span class="n">supply</span><span class="p">,</span> <span class="n">consumption</span><span class="p">,</span> <span class="n">grid_feedin</span><span class="p">,</span> <span class="n">grid_consumption</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="n">feedin</span><span class="p">])</span>
<span class="n">out_benchmark</span>   <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">portf</span><span class="o">=</span><span class="n">portf_benchmark</span><span class="p">,</span> <span class="n">timegrid</span><span class="o">=</span><span class="n">timegrid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">input_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Interpretation-of-the-results">
<h2>Interpretation of the results<a class="headerlink" href="#Interpretation-of-the-results" title="Link to this heading"></a></h2>
<p>Let us analyze the overall costs with and without battery and look into the dispatch behaviour</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overall costs with battery:    &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overall costs without battery: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;So the battery saved us:       &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overall costs with battery:    29975
Overall costs without battery: 49494
So the battery saved us:       19519
</pre></div></div>
</div>
<p>There is a significant saving. But where does the saving come from? Let us look into the details, starting with the overall quantities. See below. Note how quantities are always balanced at nodes. Transport always balances as well – transporting from one node to the other.</p>
<p>Check out the output “out” in detail. It contains detailed dispatch, cash flows and internal variables such as battery fill levels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantities (MWh) with battery:</span><span class="se">\n</span><span class="s1">.................................... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;dispatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantities (MWh) without battery:</span><span class="se">\n</span><span class="s1">.................................... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;dispatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Quantities (MWh) with battery:
....................................
supply (front of meter)       376.0
consumption (behind meter)   -500.0
grid_out (behind meter)      -103.0
grid_out (front of meter)     103.0
grid_in (front of meter)     -376.0
grid_in (behind meter)        376.0
pv (behind meter)             250.0
feedin (front of meter)      -103.0
battery (behind meter)        -23.0
dtype: float64

Quantities (MWh) without battery:
....................................
supply (front of meter)       310.0
consumption (behind meter)   -500.0
grid_out (behind meter)       -60.0
grid_out (front of meter)      60.0
grid_in (front of meter)     -310.0
grid_in (behind meter)        310.0
pv (behind meter)             250.0
feedin (front of meter)       -60.0
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Costs (EUR) with battery:</span><span class="se">\n</span><span class="s1">.................................... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total:  &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Costs (EUR) without battery:</span><span class="se">\n</span><span class="s1">.................................... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total:  &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Costs (EUR) with battery:
....................................
supply        -26178.0
consumption        0.0
grid_out           0.0
grid_in       -15948.0
pv                 0.0
feedin         12152.0
battery            0.0
dtype: float64
Total:  -29975.0

Costs (EUR) without battery:
....................................
supply        -27711.0
consumption        0.0
grid_out           0.0
grid_in       -22788.0
pv                 0.0
feedin          1006.0
dtype: float64
Total:  -49494.0

</pre></div></div>
</div>
<p>There are two contributions:</p>
<ul class="simple">
<li><p>supply &amp; PV: we are utilizing the battery to maximize own consumption, mainly to avoid variable grid fees</p></li>
<li><p>battery &amp; grid: we try to minimize peak load (capacity fee)</p></li>
<li><p>battery arbitrage: utilizing the battery to consume from grid in cheap hours and feed in in expensive hours</p></li>
</ul>
<p>Everything is optimized in a consistent manner in one go!</p>
<p>The grid connection is a special case: Besides avoiding variable grid fees, we’re sizing the capacity over the course of the year, utilizing the battery to reduce peaks. Here the results. “Value” gives the required capacity:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Grid fixed costs (EUR) with battery:</span><span class="se">\n</span><span class="s1">.................................................. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;special&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Grid fixed costs (EUR) without battery:</span><span class="se">\n</span><span class="s1">.................................................. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;special&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Grid fixed costs (EUR) with battery:
..................................................
     asset variable   name  value     costs
0  grid_in     size  scale  0.066  11058.95

Grid fixed costs (EUR) without battery:
..................................................
     asset variable   name  value      costs
0  grid_in     size  scale  0.113  18754.337
</pre></div></div>
</div>
</section>
<section id="Another-benchmark:-Own-PV">
<h2>Another benchmark: Own PV<a class="headerlink" href="#Another-benchmark:-Own-PV" title="Link to this heading"></a></h2>
<p>To make the picture more complete, let us add another step in the benchmark: to compute the value of the own PV (i.e. a portfolio without PV and battery as the overall starting point)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">portf_start</span> <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">portfolio</span><span class="o">.</span><span class="n">Portfolio</span><span class="p">([</span><span class="n">supply</span><span class="p">,</span> <span class="n">consumption</span><span class="p">,</span> <span class="n">grid_feedin</span><span class="p">,</span> <span class="n">grid_consumption</span><span class="p">,</span> <span class="n">feedin</span><span class="p">])</span>
<span class="n">out_start</span>   <span class="o">=</span> <span class="n">eao</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">portf</span><span class="o">=</span><span class="n">portf_start</span><span class="p">,</span> <span class="n">timegrid</span><span class="o">=</span><span class="n">timegrid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">input_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Putting-everything-together">
<h2>Putting everything together<a class="headerlink" href="#Putting-everything-together" title="Link to this heading"></a></h2>
<p>Let us now put all the data together to analyze the effects of our PV and battery assets. Naturally, we could also do this in Excel, using the output generated by the optimization. This may feel more natural to many users.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## bookkeeping - looking at cost components in different scenarios. Attention - costs are negative numbers</span>
<span class="n">start</span>  <span class="o">=</span> <span class="o">-</span><span class="n">out_start</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span> <span class="c1"># no assets</span>
<span class="n">with_pv</span> <span class="o">=</span> <span class="o">-</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span>  <span class="c1"># PV, no battery</span>
<span class="n">saving_supply</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;supply&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;feedin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">-</span> <span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;supply&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;feedin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="n">saving_grid</span>   <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">out_benchmark</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;grid_in&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;DCF&#39;</span><span class="p">][</span><span class="s1">&#39;grid_in&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## create a waterfall chart. Thanks for the great module provided by the waterfall_ax team! Very handy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">waterfall_ax</span><span class="w"> </span><span class="kn">import</span> <span class="n">WaterfallChart</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Cumulative values</span>
<span class="n">step_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Start: grid supply only&#39;</span><span class="p">,</span> <span class="s1">&#39;savings PV&#39;</span><span class="p">,</span>          <span class="s1">&#39;battery: savings supply&#39;</span><span class="p">,</span><span class="s1">&#39;and grid fees&#39;</span><span class="p">]</span>
<span class="n">step_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">,</span>                     <span class="n">with_pv</span><span class="p">,</span>               <span class="n">with_pv</span><span class="o">-</span><span class="n">saving_supply</span><span class="p">,</span>    <span class="n">with_pv</span><span class="o">-</span><span class="n">saving_supply</span><span class="o">-</span><span class="n">saving_grid</span><span class="p">]</span>
<span class="n">last_step_label</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
<span class="n">color_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;c_bar_pos&#39;</span><span class="p">:</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_bar_neg&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_bar_start&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_bar_end&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_text_pos&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_text_neg&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_text_start&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c_text_end&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span>
<span class="p">}</span>
<span class="c1"># Plot</span>
<span class="n">waterfall</span> <span class="o">=</span> <span class="n">WaterfallChart</span><span class="p">(</span><span class="n">step_values</span><span class="p">,</span> <span class="n">step_names</span><span class="o">=</span><span class="n">step_names</span><span class="p">,</span> <span class="n">last_step_label</span><span class="o">=</span><span class="n">last_step_label</span><span class="p">)</span>
<span class="n">wf_ax</span> <span class="o">=</span> <span class="n">waterfall</span><span class="o">.</span><span class="n">plot_waterfall</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Reducing power costs with own PV and battery&#39;</span><span class="p">,</span> <span class="n">color_kwargs</span><span class="o">=</span><span class="n">color_kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;yearly costs in EUR&#39;</span><span class="p">)</span>
<span class="n">wf_ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/samples_grid_and_battery_battery_own_consumption_26_0.png" src="../../_images/samples_grid_and_battery_battery_own_consumption_26_0.png" />
</div>
</div>
<p>… that was it! No rocket science, as you see.</p>
</section>
</section>


           </div>
          </div>
          <div role="contentinfo">
    <p>
        &copy 2025 - <a href="https://rivacon.com/impressum/">Impressum</a>
    </p>
</div>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>